(ns cli-skeleton\main
  (:require phel\json :as json)
  (:require-file "vendor/autoload.php")
  (:use PhpParser\Error :as PPError)
  (:use PhpParser\ParserFactory))

(def code
"<?php
function test($foo)
{
    var_dump($foo);
}
CODE;
"
)

(def parser (php/-> (php/new ParserFactory) (createForNewestSupportedVersion)))
(def ast-php (php/-> parser (parse code)))
(def ast-json (php/json_encode ast-php php/JSON_PRETTY_PRINT))
(def ast (json/decode ast-json))

(when-not *build-mode*
  (println ast))
